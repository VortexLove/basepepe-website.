<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Pepe Blackjack (PBJ) - Compra de Tokens</title>
    <script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
    <style>
      body { font-family: 'Press Start 2P', cursive; }
    </style>
  </head>
  <body class="bg-gradient-to-br from-purple-900 via-pink-900 to-purple-800 text-white min-h-screen">
    <div class="max-w-4xl mx-auto p-4 space-y-8">
      <!-- Header -->
      <header class="flex justify-between items-center py-4 border-b border-pink-500">
        <h1 class="text-3xl font-bold text-pink-400">Pepe Blackjack (PBJ)</h1>
        <button id="connectButton" class="bg-pink-500 hover:bg-pink-600 px-4 py-2 rounded text-white">Conectar Wallet</button>
      </header>

      <div id="status" class="text-center text-xs"></div>

      <!-- Componente de Compra -->
      <section class="bg-purple-900 bg-opacity-70 p-6 rounded-xl shadow-2xl">
        <h2 class="text-2xl mb-4 text-pink-400">üöÄ Compra de Tokens</h2>
        <div class="mb-4 flex justify-between text-xs">
          <span>Saldo de ETH:</span>
          <span id="ethBalance">- ETH</span>
        </div>
        <!-- Selector ETH / PBJ -->
        <div class="flex gap-2 mb-4 text-xs">
          <button id="modeEth" class="flex-1 py-2 rounded bg-pink-600 hover:bg-pink-700">Pagar con ETH</button>
          <button id="modePbj" class="flex-1 py-2 rounded bg-pink-600 hover:bg-pink-700">Pagar con PBJ</button>
        </div>
        <!-- Inputs -->
        <div class="space-y-4 text-xs">
          <div class="flex items-center justify-between">
            <label for="ethAmount">ETH:</label>
            <input type="number" id="ethAmount" min="0.01" step="0.01" value="0.01" class="w-24 p-2 rounded bg-purple-800 text-white text-xs" />
          </div>
          <div class="flex items-center justify-between">
            <label for="pbjAmount">PBJ:</label>
            <input type="number" id="pbjAmount" min="10000" step="10000" class="w-24 p-2 rounded bg-purple-800 text-white text-xs" />
          </div>
        </div>
        <div class="text-right">
          <button id="buyButton" disabled class="mt-4 bg-pink-500 hover:bg-pink-600 px-6 py-2 rounded text-xs">Comprar</button>
        </div>
      </section>

      <!-- Lore -->
      <section class="bg-purple-900 bg-opacity-70 p-6 rounded-xl shadow-2xl text-xs">
        <h2 class="text-xl mb-2 text-pink-400">üìñ Lore</h2>
        <p>
          Pepe Blackjack (PBJ) nace en las mesas digitales del ciber-casino de las ranas legendarias. Fusiona el esp√≠ritu meme con la adrenalina del blackjack,
          brindando una experiencia Web3 √∫nica de riesgo y recompensa.
        </p>
      </section>

      <!-- Roadmap -->
      <section class="bg-purple-900 bg-opacity-70 p-6 rounded-xl shadow-2xl text-xs">
        <h2 class="text-xl mb-2 text-pink-400">üó∫Ô∏è Roadmap</h2>
        <ul class="list-decimal list-inside space-y-2">
          <li><strong>Fase 1 (Q2 2025):</strong> Preventa en Base y lanzamiento del token PBJ.</li>
          <li><strong>Fase 2 (Q3 2025):</strong> Listado en DEX y staking de PBJ con recompensas exclusivas.</li>
          <li><strong>Fase 3 (Q4 2025):</strong> Lanzamiento del Blackjack Web3: mesas p√∫blicas y privadas.</li>
          <li><strong>Fase 4 (Q1 2026):</strong> Integraci√≥n de Slots, Ruleta y Dados: la segunda tanda de juegos.</li>
          <li><strong>Fase 5 (Q2 2026):</strong> Lanzamiento de Poker y Loter√≠a Blockchain con jackpots progresivos.</li>
          <li><strong>Fase 6 (Q3 2026):</strong> Modo Casino Social: torneos, chat y sistema de niveles para jugadores.</li>
          <li><strong>Fase 7 (Q4 2026):</strong> Integraci√≥n NFT: compra y personalizaci√≥n de avatares y mesas.</li>
          <li><strong>Fase 8 (Q1 2027):</strong> Expansi√≥n Metaverso: casino en entorno 3D VR con mundos tem√°ticos.</li>
          <li><strong>Fase 9 (Q2 2027):</strong> Alianzas y eventos globales: torneos con criptomonedas y tokens de socios.</li>
        </ul>
      </section>

      <!-- Tokenomics -->
      <section class="bg-purple-900 bg-opacity-70 p-6 rounded-xl shadow-2xl text-xs">
        <h2 class="text-xl mb-2 text-pink-400">üìä Tokenomics</h2>
        <ul class="space-y-1">
          <li><strong>S√≠mbolo:</strong> PBJ</li>
          <li><strong>Red:</strong> Base</li>
          <li><strong>Supply total:</strong> 1,000,000,000 PBJ</li>
          <li><strong>Precio:</strong> 1 ETH = 1,000,000 PBJ</li>
          <li><strong>Contrato:</strong> <a href="https://basescan.org/address/0x3Bcc79d679d900b78684F44FF7DacC286fAb0C57" class="text-pink-300 underline" target="_blank">0x3Bcc...0C57</a></li>
        </ul>
      </section>

      <!-- Equipo y Enlaces -->
      <section class="bg-purple-900 bg-opacity-70 p-6 rounded-xl shadow-2xl text-xs">
        <h2 class="text-xl mb-2 text-pink-400">üë• Equipo y Enlaces</h2>
        <ul class="space-y-1">
          <li><strong>Equipo Clave:</strong> Jane Doe (Dev), John Smith (Marketing), CryptoFrogDAO (Comunidad)</li>
          <li><strong>Sitio oficial:</strong> <a href="#" class="text-pink-300 underline">www.pepeblackjack.io</a></li>
          <li><strong>Twitter:</strong> <a href="https://twitter.com/pepeblackjack" class="text-pink-300 underline">@pepeblackjack</a></li>
          <li><strong>Telegram:</strong> <a href="https://t.me/pepeblackjack" class="text-pink-300 underline">@pepeblackjack</a></li>
        </ul>
      </section>

      <!-- FAQ -->
      <section class="bg-purple-900 bg-opacity-70 p-6 rounded-xl shadow-2xl text-xs">
        <h2 class="text-xl mb-2 text-pink-400">‚ùì FAQ</h2>
        <div class="space-y-3">
          <div>
            <h3 class="font-bold">¬øC√≥mo compro PBJ?</h3>
            <p>Conecta tu wallet, elige ETH o PBJ, ajusta la cantidad y haz clic en "Comprar".</p>
          </div>
          <div>
            <h3 class="font-bold">¬øMonto m√≠nimo?</h3>
            <p>0.01 ETH (10,000 PBJ).</p>
          </div>
          <div>
            <h3 class="font-bold">¬øQu√© pasa al finalizar la preventa?</h3>
            <p>Se llama <code>endPresale()</code>, habilitando solo intercambios en DEX.</p>
          </div>
        </div>
      </section>
    </div>

    <script>
      const contractAddress = '0x3Bcc79d679d900b78684F44FF7DacC286fAb0C57';
      const abi = ['function buyTokens() payable'];
      const rate = 1000000;
      let provider, signer, contract;
      const connectButton = document.getElementById('connectButton');
      const buyButton = document.getElementById('buyButton');
      const statusDiv = document.getElementById('status');
      const ethAmountInput = document.getElementById('ethAmount');
      const pbjAmountInput = document.getElementById('pbjAmount');
      const modeEth = document.getElementById('modeEth');
      const modePbj = document.getElementById('modePbj');
      const ethBalanceSpan = document.getElementById('ethBalance');
      let buyMode = 'ETH';
      function updateEstimate() {
        const ethVal = parseFloat(ethAmountInput.value) || 0;
        const pbjVal = parseFloat(pbjAmountInput.value) || 0;
        if (buyMode === 'ETH') pbjAmountInput.value = (ethVal * rate).toFixed(0);
        else ethAmountInput.value = (pbjVal / rate).toFixed(6);
      }
      modeEth.onclick = () => { buyMode = 'ETH'; modeEth.classList.add('bg-pink-700'); modePbj.classList.remove('bg-pink-700'); ethAmountInput.removeAttribute('disabled'); pbjAmountInput.setAttribute('disabled', true); updateEstimate(); };
      modePbj.onclick = () => { buyMode = 'PBJ'; modePbj.classList.add('bg-pink-700'); modeEth.classList.remove('bg-pink-700'); pbjAmountInput.removeAttribute('disabled'); ethAmountInput.setAttribute('disabled', true); updateEstimate(); };
      ethAmountInput.addEventListener('input', updateEstimate);
      pbjAmountInput.addEventListener('input', updateEstimate);
      connectButton.onclick = async () => {
        if (window.ethereum) {
          provider = new ethers.providers.Web3Provider(window.ethereum);
          await provider.send('eth_requestAccounts', []);
          signer = provider.getSigner();
          contract = new ethers.Contract(contractAddress, abi, signer);
          const addr = await signer.getAddress();
          const bal = await provider.getBalance(addr);
          ethBalanceSpan.innerText = `${parseFloat(ethers.utils.formatEther(bal)).toFixed(4)} ETH`;
          statusDiv.innerText = '‚úÖ Wallet conectada';
          buyButton.disabled = false;
        } else statusDiv.innerText = 'MetaMask no detectado';
      };
      buyButton.onclick = async () => {
        try {
          const ethVal = buyMode === 'ETH' ? parseFloat(ethAmountInput.value) : parseFloat(ethAmountInput.value);
          const value = ethers.utils.parseEther(ethVal.toString());
          statusDiv.innerText = '‚åõ Confirma en MetaMask';
          const tx = await contract.buyTokens({ value });
          statusDiv.innerText = `üì® Tx: ${tx.hash.slice(0,10)}...`;
          await tx.wait(); statusDiv.innerText = '‚úÖ Compra exitosa';
        } catch (e) { statusDiv.innerText = '‚ùå ' + (e.data?.message || e.message); }
      };
      modeEth.click();
    </script>
  </body>
</html>
